<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTL Snake Game - TÃ i Liá»‡u Dá»± Ãn</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --accent-color: #FF5722;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --text-primary: #eaeaea;
            --text-secondary: #b8b8b8;
            --code-bg: #0f3460;
            --border-color: #4a5568;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f0f23 100%);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(135deg, var(--primary-color) 0%, #1b5e20 100%);
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(76, 175, 80, 0.3);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        .header .meta {
            margin-top: 20px;
            font-size: 0.95rem;
            opacity: 0.8;
        }

        /* Navigation */
        .nav-box {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 4px solid var(--secondary-color);
        }

        .nav-box h2 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .nav-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            background: var(--code-bg);
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-links a:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
        }

        /* Sections */
        .section {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .section h2 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 {
            color: var(--secondary-color);
            font-size: 1.3rem;
            margin: 25px 0 15px 0;
        }

        .section h4 {
            color: var(--accent-color);
            font-size: 1.1rem;
            margin: 20px 0 10px 0;
        }

        /* Code blocks */
        pre {
            background: var(--code-bg);
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid var(--primary-color);
        }

        code {
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9rem;
            color: #e8e8e8;
        }

        .inline-code {
            background: var(--code-bg);
            padding: 3px 8px;
            border-radius: 5px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.85rem;
            color: #ffd700;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--code-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        th,
        td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(76, 175, 80, 0.1);
        }

        /* Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: var(--code-bg);
            border-radius: 12px;
            padding: 25px;
            border-top: 4px solid var(--primary-color);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Highlight boxes */
        .highlight-box {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(33, 150, 243, 0.1));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-color);
        }

        .highlight-box.important {
            border-left-color: var(--accent-color);
            background: linear-gradient(135deg, rgba(255, 87, 34, 0.1), rgba(255, 152, 0, 0.1));
        }

        .highlight-box.info {
            border-left-color: var(--secondary-color);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(3, 169, 244, 0.1));
        }

        /* Lists */
        ul,
        ol {
            padding-left: 25px;
            margin: 15px 0;
        }

        li {
            margin: 10px 0;
            color: var(--text-secondary);
        }

        li strong {
            color: var(--text-primary);
        }

        /* Diagrams */
        .diagram {
            background: var(--code-bg);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            font-family: 'Fira Code', monospace;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.4;
            color: #00ff88;
        }

        /* Tags */
        .tag {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 3px;
        }

        .tag.blue {
            background: var(--secondary-color);
        }

        .tag.orange {
            background: var(--accent-color);
        }

        .tag.purple {
            background: #9c27b0;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .section {
                padding: 20px;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ BTL SNAKE GAME</h1>
            <p class="subtitle">BÃ i Táº­p Lá»›n - Láº­p TrÃ¬nh á»¨ng Dá»¥ng Di Äá»™ng</p>
            <p class="meta">Android Native Game | Java | Canvas 2D Graphics</p>
        </div>

        <!-- Navigation -->
        <div class="nav-box">
            <h2>ğŸ“‹ Má»¥c Lá»¥c</h2>
            <div class="nav-links">
                <a href="#overview">Tá»•ng Quan</a>
                <a href="#architecture">Kiáº¿n TrÃºc</a>
                <a href="#libraries">ThÆ° Viá»‡n Sá»­ Dá»¥ng</a>
                <a href="#special-features">Äiá»ƒm KhÃ¡c Biá»‡t</a>
                <a href="#canvas-drawing">Váº½ Báº±ng Canvas</a>
                <a href="#game-loop">Game Loop</a>
                <a href="#important-functions">CÃ¡c HÃ m Quan Trá»ng</a>
                <a href="#design-patterns">Design Patterns</a>
            </div>
        </div>

        <!-- 1. Overview Section -->
        <div class="section" id="overview">
            <h2>ğŸ“± 1. Tá»•ng Quan Dá»± Ãn</h2>

            <p>Dá»± Ã¡n <strong>Snake Game</strong> lÃ  má»™t game ráº¯n sÄƒn má»“i Ä‘Æ°á»£c phÃ¡t triá»ƒn trÃªn ná»n táº£ng Android, sá»­ dá»¥ng
                Java vÃ  Canvas 2D Ä‘á»ƒ render Ä‘á»“ há»a theo thá»i gian thá»±c. Game cÃ³ Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng tá»« menu, cÃ i Ä‘áº·t, Ä‘áº¿n
                gameplay vá»›i Ã¢m thanh vÃ  hiá»‡u á»©ng.</p>

            <div class="card-grid">
                <div class="card">
                    <h4>ğŸ¯ Má»¥c TiÃªu</h4>
                    <p>XÃ¢y dá»±ng game hoÃ n chá»‰nh vá»›i kiáº¿n trÃºc rÃµ rÃ ng, tÃ¡ch biá»‡t logic - UI - assets</p>
                </div>
                <div class="card">
                    <h4>ğŸ’» Ná»n Táº£ng</h4>
                    <p>Android Native (API 24+), viáº¿t báº±ng Java thuáº§n, khÃ´ng dÃ¹ng game engine</p>
                </div>
                <div class="card">
                    <h4>ğŸ¨ Äá»“ Há»a</h4>
                    <p>Canvas 2D vá»›i Bitmap sprites, há»— trá»£ xoay áº£nh theo hÆ°á»›ng di chuyá»ƒn</p>
                </div>
                <div class="card">
                    <h4>ğŸ”Š Ã‚m Thanh</h4>
                    <p>Nháº¡c ná»n (MediaPlayer) + Sound Effects (SoundPool) riÃªng biá»‡t</p>
                </div>
            </div>

            <h3>Cáº¥u TrÃºc Package</h3>
            <pre><code>com.example.btl_snake_game/
â”œâ”€â”€ MainActivity.java           # Entry point
â”œâ”€â”€ game/                       # Game logic layer
â”‚   â”œâ”€â”€ GameController.java     # Äiá»u phá»‘i game
â”‚   â”œâ”€â”€ GameEngine.java         # Logic game chÃ­nh
â”‚   â”œâ”€â”€ GameState.java          # Enum states
â”‚   â””â”€â”€ objects/
â”‚       â”œâ”€â”€ Snake.java          # Äá»‘i tÆ°á»£ng ráº¯n
â”‚       â””â”€â”€ Food.java           # Äá»‘i tÆ°á»£ng thá»©c Äƒn
â”œâ”€â”€ ui/                         # UI layer
â”‚   â”œâ”€â”€ GameActivity.java       # MÃ n chÆ¡i game
â”‚   â”œâ”€â”€ MenuActivity.java       # MÃ n menu chÃ­nh
â”‚   â”œâ”€â”€ SettingActivity.java    # MÃ n cÃ i Ä‘áº·t
â”‚   â”œâ”€â”€ GameView.java           # Custom View váº½ Canvas
â”‚   â”œâ”€â”€ GameThread.java         # Thread game loop
â”‚   â””â”€â”€ InputHandler.java       # Xá»­ lÃ½ gesture
â””â”€â”€ util/                       # Utilities
    â”œâ”€â”€ AssetManager.java       # Quáº£n lÃ½ assets
    â”œâ”€â”€ SettingManager.java     # LÆ°u cÃ i Ä‘áº·t (SharedPreferences)
    â”œâ”€â”€ SoundManager.java       # Quáº£n lÃ½ Ã¢m thanh
    â””â”€â”€ Vector2D.java           # Lá»›p toáº¡ Ä‘á»™ 2D</code></pre>
        </div>

        <!-- 2. Libraries Section -->
        <div class="section" id="libraries">
            <h2>ğŸ“š 2. ThÆ° Viá»‡n VÃ  APIs Sá»­ Dá»¥ng</h2>

            <div class="highlight-box info">
                <strong>ğŸ’¡ LÆ°u Ã½:</strong> Dá»± Ã¡n chá»§ yáº¿u sá»­ dá»¥ng Android SDK APIs thay vÃ¬ thÆ° viá»‡n bÃªn ngoÃ i, giÃºp giáº£m
                kÃ­ch thÆ°á»›c APK vÃ  tÄƒng hiá»‡u nÄƒng.
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ThÆ° Viá»‡n / API</th>
                        <th>Má»¥c ÄÃ­ch Sá»­ Dá»¥ng</th>
                        <th>Package</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="inline-code">android.graphics.Canvas</span></td>
                        <td>Váº½ Ä‘á»“ há»a 2D (ráº¯n, thá»©c Äƒn, background, UI popups)</td>
                        <td>GameView</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.graphics.Paint</span></td>
                        <td>Äáº·t mÃ u sáº¯c, style, font chá»¯ cho cÃ¡c Ä‘á»‘i tÆ°á»£ng váº½</td>
                        <td>GameView</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.graphics.Bitmap</span></td>
                        <td>Load vÃ  hiá»ƒn thá»‹ sprite images tá»« assets</td>
                        <td>AssetManager, GameView</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.view.GestureDetector</span></td>
                        <td>Nháº­n diá»‡n cá»­ chá»‰ vuá»‘t (swipe) Ä‘á»ƒ Ä‘iá»u khiá»ƒn ráº¯n</td>
                        <td>InputHandler</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.media.MediaPlayer</span></td>
                        <td>PhÃ¡t nháº¡c ná»n dáº¡ng loop (menu music, game music)</td>
                        <td>SoundManager</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.media.SoundPool</span></td>
                        <td>PhÃ¡t sound effects ngáº¯n (Äƒn má»“i, cháº¿t)</td>
                        <td>SoundManager</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.content.SharedPreferences</span></td>
                        <td>LÆ°u trá»¯ cÃ i Ä‘áº·t vÃ  high score vÃ o bá»™ nhá»›</td>
                        <td>SettingManager</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">android.graphics.Typeface</span></td>
                        <td>Load custom font tá»« assets (yoster.ttf)</td>
                        <td>AssetManager</td>
                    </tr>
                    <tr>
                        <td><span class="inline-code">ViewTreeObserver</span></td>
                        <td>Äá»£i View Ä‘Æ°á»£c layout xong Ä‘á»ƒ láº¥y kÃ­ch thÆ°á»›c chÃ­nh xÃ¡c</td>
                        <td>GameController</td>
                    </tr>
                </tbody>
            </table>

            <h3>Dependencies trong Gradle</h3>
            <pre><code>dependencies {
    implementation(libs.appcompat)           // AndroidX AppCompat
    implementation(libs.material)            // Material Design Components
    implementation(libs.activity)            // Activity lifecycle
    implementation(libs.constraintlayout)    // ConstraintLayout cho UI
}</code></pre>
        </div>

        <!-- 3. Special Features Section -->
        <div class="section" id="special-features">
            <h2>â­ 3. Äiá»ƒm KhÃ¡c Biá»‡t So Vá»›i BÃ i Táº­p CÆ¡ Báº£n</h2>

            <div class="highlight-box important">
                <strong>ğŸ”¥ KhÃ¡c biá»‡t chÃ­nh:</strong> Thay vÃ¬ chá»‰ váº½ hÃ¬nh Ä‘Æ¡n giáº£n, dá»± Ã¡n nÃ y sá»­ dá»¥ng
                <strong>sprite-based rendering</strong> vá»›i kháº£ nÄƒng <strong>xoay áº£nh theo hÆ°á»›ng di chuyá»ƒn</strong>,
                cÃ¹ng há»‡ thá»‘ng <strong>Ã¢m thanh Ä‘a lá»›p</strong> vÃ  <strong>quáº£n lÃ½ state chuyÃªn nghiá»‡p</strong>.
            </div>

            <h3>3.1 Váº½ Ráº¯n Vá»›i Canvas - Xoay Äáº§u Theo HÆ°á»›ng</h3>
            <p>Äiá»ƒm Ä‘áº·c biá»‡t nháº¥t lÃ  viá»‡c xoay sprite Ä‘áº§u ráº¯n theo hÆ°á»›ng di chuyá»ƒn báº±ng phÃ©p biáº¿n Ä‘á»•i Canvas:</p>
            <pre><code>private void drawRotatedHead(Canvas canvas, Bitmap bitmap, Vector2D position, Vector2D dir, int cellSize) {
    float angle = 0;
    
    // TÃ­nh gÃ³c xoay dá»±a trÃªn hÆ°á»›ng (áº£nh gá»‘c nhÃ¬n sang PHáº¢I)
    if (dir.getX() > 0) angle = 0;          // Sang pháº£i
    else if (dir.getX() < 0) angle = 180;   // Sang trÃ¡i  
    else if (dir.getY() > 0) angle = 90;    // Äi xuá»‘ng
    else if (dir.getY() < 0) angle = 270;   // Äi lÃªn

    canvas.save();  // LÆ°u tráº¡ng thÃ¡i canvas
    
    // Xoay quanh tÃ¢m Ä‘áº§u ráº¯n
    float centerX = position.getX() + cellSize / 2f;
    float centerY = position.getY() + cellSize / 2f;
    canvas.rotate(angle, centerX, centerY);
    
    // Váº½ Ä‘áº§u Ä‘Ã£ xoay
    Rect destRect = new Rect(position.getX(), position.getY(),
            position.getX() + cellSize, position.getY() + cellSize);
    canvas.drawBitmap(bitmap, null, destRect, null);
    
    canvas.restore();  // KhÃ´i phá»¥c canvas
}</code></pre>

            <h3>3.2 Há»‡ Thá»‘ng Ã‚m Thanh Äa Lá»›p</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>MediaPlayer - Nháº¡c Ná»n</h4>
                    <p>PhÃ¡t file MP3 dÃ i, há»— trá»£ loop vÃ´ háº¡n. TÃ¡ch riÃªng nháº¡c menu vÃ  nháº¡c game.</p>
                    <span class="tag">Looping</span>
                    <span class="tag blue">Long Audio</span>
                </div>
                <div class="card">
                    <h4>SoundPool - Sound Effects</h4>
                    <p>PhÃ¡t hiá»‡u á»©ng ngáº¯n (Äƒn má»“i, cháº¿t) vá»›i Ä‘á»™ trá»… tháº¥p. CÃ³ thá»ƒ overlap nhiá»u Ã¢m thanh.</p>
                    <span class="tag orange">Low Latency</span>
                    <span class="tag purple">Overlap</span>
                </div>
            </div>

            <h3>3.3 Game Loop Vá»›i FPS Äá»™ng</h3>
            <p>FPS tá»± Ä‘á»™ng tÄƒng theo Ä‘iá»ƒm sá»‘ Ä‘á»ƒ game khÃ³ hÆ¡n dáº§n:</p>
            <pre><code>// FPS tÄƒng dáº§n theo score: base + score/50, tá»‘i Ä‘a MAX_FPS
currentFPS = Math.min(baseFPS + score / 50, MAX_FPS);

// Hard mode: base = 8 FPS, Easy mode: base = 5 FPS</code></pre>

            <h3>3.4 Cháº¿ Äá»™ ChÆ¡i KhÃ¡c Nhau</h3>
            <table>
                <tr>
                    <th>TÃ­nh NÄƒng</th>
                    <th>Easy Mode</th>
                    <th>Hard Mode</th>
                </tr>
                <tr>
                    <td>Tá»‘c Ä‘á»™ cÆ¡ báº£n</td>
                    <td>5 FPS</td>
                    <td>8 FPS</td>
                </tr>
                <tr>
                    <td>Äá»¥ng tÆ°á»ng</td>
                    <td>Äi xuyÃªn qua (wrap)</td>
                    <td>Game Over</td>
                </tr>
            </table>

            <h3>3.5 Custom Font Tá»« Assets</h3>
            <pre><code>// Load font pixel-art style
gameFont = Typeface.createFromAsset(context.getAssets(), "fonts/yoster.ttf");

// Ãp dá»¥ng cho Paint khi váº½ text
textPaint.setTypeface(AssetManager.gameFont);</code></pre>
        </div>

        <!-- 4. Canvas Drawing Section -->
        <div class="section" id="canvas-drawing">
            <h2>ğŸ¨ 4. Váº½ Äá»“ Há»a Báº±ng Canvas</h2>

            <p>ToÃ n bá»™ Ä‘á»“ há»a game Ä‘Æ°á»£c render trong <span class="inline-code">GameView.onDraw(Canvas canvas)</span>:
            </p>

            <h3>Quy TrÃ¬nh Render Má»—i Frame</h3>
            <div class="diagram">
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ onDraw(Canvas) â”‚
                â”‚ â”‚
                â”‚ 1. drawBackground() â†’ Tile background image â”‚
                â”‚ â†“ â”‚
                â”‚ 2. drawFood() â†’ Váº½ bitmap thá»©c Äƒn â”‚
                â”‚ â†“ â”‚
                â”‚ 3. drawSnake() â†’ Váº½ Ä‘áº§u (xoay) + thÃ¢n ráº¯n â”‚
                â”‚ â†“ â”‚
                â”‚ 4. drawGameOver() â†’ Popup khi thua (náº¿u cÃ³) â”‚
                â”‚ â†“ â”‚
                â”‚ 5. drawPausePopup() â†’ Popup táº¡m dá»«ng (náº¿u cÃ³) â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <h3>Code Váº½ Thá»©c Ä‚n (Fallback graceful)</h3>
            <pre><code>private void drawFood(Canvas canvas) {
    Vector2D foodPos = gameEngine.getFood().getPosition();
    int cellSize = gameEngine.getCellSize();
    Bitmap foodBmp = AssetManager.food;

    if (foodBmp != null) {
        // CÃ³ áº£nh â†’ váº½ bitmap
        Rect destRect = new Rect(foodPos.getX(), foodPos.getY(),
                foodPos.getX() + cellSize, foodPos.getY() + cellSize);
        canvas.drawBitmap(foodBmp, null, destRect, null);
    } else {
        // KhÃ´ng cÃ³ áº£nh â†’ váº½ hÃ¬nh trÃ²n Ä‘á»
        float centerX = foodPos.getX() + cellSize / 2f;
        float centerY = foodPos.getY() + cellSize / 2f;
        canvas.drawCircle(centerX, centerY, cellSize / 2f - 2, foodPaint);
    }
}</code></pre>

            <h3>Ká»¹ Thuáº­t Tile Background</h3>
            <pre><code>private void drawBackground(Canvas canvas) {
    Bitmap bgBitmap = AssetManager.gameBackground;
    
    if (bgBitmap != null) {
        // Láº·p áº£nh ná»n theo cáº£ 2 chiá»u Ä‘á»ƒ phá»§ kÃ­n mÃ n hÃ¬nh
        for (int x = 0; x < getWidth(); x += bgBitmap.getWidth()) {
            for (int y = 0; y < getHeight(); y += bgBitmap.getHeight()) {
                canvas.drawBitmap(bgBitmap, x, y, null);
            }
        }
    } else {
        canvas.drawColor(Color.rgb(34, 139, 34)); // Forest Green fallback
    }
}</code></pre>
        </div>

        <!-- 5. Game Loop Section -->
        <div class="section" id="game-loop">
            <h2>ğŸ”„ 5. Game Loop Thread</h2>

            <p><span class="inline-code">GameThread</span> lÃ  má»™t Thread riÃªng cháº¡y song song, Ä‘áº£m báº£o game mÆ°á»£t mÃ  mÃ 
                khÃ´ng block UI thread:</p>

            <div class="diagram">
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GAME LOOP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ â”‚
                â”‚ while (alive) { â”‚
                â”‚ startTime = System.currentTimeMillis() â”‚
                â”‚ â”‚ â”‚
                â”‚ â–¼ â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ â”‚ if (running) â”‚ â”‚
                â”‚ â”‚ gameEngine.update() â”‚ â† Logic update â”‚
                â”‚ â”‚ notifyScoreChange() â”‚ â”‚
                â”‚ â”‚ adjustFPS() â”‚ â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â”‚ â”‚ â”‚
                â”‚ â–¼ â”‚
                â”‚ gameView.postInvalidate() â† Trigger redraw â”‚
                â”‚ â”‚ â”‚
                â”‚ â–¼ â”‚
                â”‚ sleep(frameTime - elapsedTime) â† FPS control â”‚
                â”‚ } â”‚
                â”‚ â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <h3>Äiá»u Chá»‰nh FPS Äá»™ng</h3>
            <pre><code>@Override
public void run() {
    while (alive) {
        long startTime = System.currentTimeMillis();

        if (running) {
            gameEngine.update();
            
            // ThÃ´ng bÃ¡o score thay Ä‘á»•i (callback pattern)
            int score = gameEngine.getScore();
            if (score != lastScore) {
                lastScore = score;
                if (scoreListener != null) {
                    scoreListener.onScoreUpdated(score);
                }
            }
            
            // FPS tÄƒng dáº§n khi score cao (khÃ³ hÆ¡n dáº§n)
            currentFPS = Math.min(baseFPS + score / 50, MAX_FPS);
        }
        
        frameTime = 1000 / currentFPS;
        gameView.postInvalidate();  // YÃªu cáº§u váº½ láº¡i tá»« worker thread

        // Sleep Ä‘á»ƒ Ä‘áº¡t Ä‘Ãºng FPS mong muá»‘n
        long elapsedTime = System.currentTimeMillis() - startTime;
        if (elapsedTime < frameTime) {
            Thread.sleep(frameTime - elapsedTime);
        }
    }
}</code></pre>
        </div>

        <!-- 6. Important Functions Section -->
        <div class="section" id="important-functions">
            <h2>âš¡ 6. CÃ¡c HÃ m Quan Trá»ng VÃ  Logic</h2>

            <h3>6.1 GameEngine.update() - TrÃ¡i Tim Game</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> Cáº­p nháº­t tráº¡ng thÃ¡i game má»—i frame - di chuyá»ƒn ráº¯n, kiá»ƒm tra va cháº¡m,
                xá»­ lÃ½ Äƒn má»“i.</p>
            <pre><code>public void update() {
    if (state != GameState.PLAYING) return;

    snake.move();  // Di chuyá»ƒn ráº¯n trÆ°á»›c

    // Xá»­ lÃ½ va cháº¡m tÆ°á»ng theo cháº¿ Ä‘á»™
    boolean isHardMode = settingManager.isHardMode();
    if (isHardMode) {
        if (snake.checkWallCollision(gridWidth, gridHeight)) {
            state = GameState.GAME_OVER;
            SoundManager.getInstance().playDieSound();
            saveHighScore();
            return;
        }
    } else {
        wrapSnakePosition();  // Easy mode: Ä‘i xuyÃªn tÆ°á»ng
    }

    // Kiá»ƒm tra Äƒn má»“i
    if (food.isEaten(snake.getHead())) {
        snake.grow();
        score += 10;
        SoundManager.getInstance().playEatSound();
        food.spawn();
        // Äáº£m báº£o food khÃ´ng spawn trÃªn thÃ¢n ráº¯n
        while (isOnSnake(food.getPosition())) {
            food.spawn();
        }
    }

    // Tá»± cáº¯n: game over
    if (snake.checkSelfCollision()) {
        state = GameState.GAME_OVER;
        SoundManager.getInstance().playDieSound();
        saveHighScore();
    }
}</code></pre>

            <h3>6.2 Snake.move() - Di Chuyá»ƒn Ráº¯n</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> Di chuyá»ƒn ráº¯n theo kiá»ƒu "Ä‘áº§u má»›i Ä‘Æ°á»£c thÃªm, Ä‘uÃ´i bá»‹ xÃ³a" - ká»¹ thuáº­t
                classic cá»§a game ráº¯n.</p>
            <pre><code>public void move() {
    direction = nextDirection;  // Ãp dá»¥ng hÆ°á»›ng má»›i (buffered)
    
    Vector2D head = body.get(0);
    Vector2D newHead = new Vector2D(
        head.getX() + direction.getX(),
        head.getY() + direction.getY()
    );

    body.add(0, newHead);  // ThÃªm Ä‘áº§u má»›i vÃ o Ä‘áº§u list

    if (!growing) {
        body.remove(body.size() - 1);  // XÃ³a Ä‘uÃ´i náº¿u khÃ´ng Ä‘ang grow
    } else {
        growing = false;  // Reset flag sau khi grow
    }
}</code></pre>

            <h3>6.3 Snake.setDirection() - Chá»‘ng Äi NgÆ°á»£c</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> KhÃ´ng cho ráº¯n Ä‘i ngÆ°á»£c láº¡i hÆ°á»›ng hiá»‡n táº¡i (vÃ­ dá»¥: Ä‘ang Ä‘i pháº£i khÃ´ng
                thá»ƒ ráº½ trÃ¡i ngay).</p>
            <pre><code>public void setDirection(Vector2D newDirection) {
    // Kiá»ƒm tra: tá»•ng 2 vector != 0 â†’ khÃ´ng ngÆ°á»£c hÆ°á»›ng
    if (direction.getX() + newDirection.getX() != 0 ||
        direction.getY() + newDirection.getY() != 0) {
        this.nextDirection = newDirection;  // Buffer Ä‘á»ƒ apply á»Ÿ frame sau
    }
}</code></pre>

            <h3>6.4 wrapSnakePosition() - Äi XuyÃªn TÆ°á»ng (Easy Mode)</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> Khi ráº¯n ra khá»i biÃªn mÃ n hÃ¬nh, xuáº¥t hiá»‡n á»Ÿ phÃ­a Ä‘á»‘i diá»‡n.</p>
            <pre><code>private void wrapSnakePosition() {
    Vector2D head = snake.getHead();
    int maxX = gridWidth * cellSize;
    int maxY = gridHeight * cellSize;

    int newX = head.getX();
    int newY = head.getY();

    // Wrap theo chiá»u ngang
    if (head.getX() < 0) newX = maxX - cellSize;
    else if (head.getX() >= maxX) newX = 0;

    // Wrap theo chiá»u dá»c
    if (head.getY() < 0) newY = maxY - cellSize;
    else if (head.getY() >= maxY) newY = 0;

    head.setX(newX);
    head.setY(newY);
}</code></pre>

            <h3>6.5 InputHandler.onFling() - Nháº­n Diá»‡n Vuá»‘t</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> Chuyá»ƒn Ä‘á»•i cá»­ chá»‰ vuá»‘t mÃ n hÃ¬nh thÃ nh hÆ°á»›ng di chuyá»ƒn cá»§a ráº¯n.</p>
            <pre><code>@Override
public boolean onFling(MotionEvent e1, MotionEvent e2,
                       float velocityX, float velocityY) {
    if (gameEngine.getState() != GameState.PLAYING) return false;

    float diffX = e2.getX() - e1.getX();
    float diffY = e2.getY() - e1.getY();

    if (Math.abs(diffX) > Math.abs(diffY)) {
        // Vuá»‘t ngang
        if (Math.abs(diffX) > SWIPE_THRESHOLD &&
            Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
            if (diffX > 0) {
                gameEngine.changeDirection(new Vector2D(cellSize, 0));  // Pháº£i
            } else {
                gameEngine.changeDirection(new Vector2D(-cellSize, 0)); // TrÃ¡i
            }
            return true;
        }
    } else {
        // Vuá»‘t dá»c
        if (Math.abs(diffY) > SWIPE_THRESHOLD &&
            Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
            if (diffY > 0) {
                gameEngine.changeDirection(new Vector2D(0, cellSize));  // Xuá»‘ng
            } else {
                gameEngine.changeDirection(new Vector2D(0, -cellSize)); // LÃªn
            }
            return true;
        }
    }
    return false;
}</code></pre>

            <h3>6.6 GameController.init() - Khá»Ÿi Táº¡o ÄÃºng Timing</h3>
            <p><strong>Váº¥n Ä‘á» giáº£i quyáº¿t:</strong> View trong Android chÆ°a cÃ³ kÃ­ch thÆ°á»›c ngay khi onCreate. Pháº£i Ä‘á»£i
                layout xong má»›i tÃ­nh Ä‘Æ°á»£c grid size.</p>
            <pre><code>public void init(Context context, GameView gameView) {
    SettingManager.getInstance().init(context);
    AssetManager assetLoader = new AssetManager(context);
    assetLoader.loadAllAssets();

    // Äá»£i View Ä‘Æ°á»£c layout xong má»›i khá»Ÿi táº¡o game
    gameView.getViewTreeObserver().addOnGlobalLayoutListener(
        new ViewTreeObserver.OnGlobalLayoutListener() {
            @Override
            public void onGlobalLayout() {
                if (!isInitialized && gameView.getWidth() > 0) {
                    initGameWithViewSize();  // BÃ¢y giá» má»›i cÃ³ kÃ­ch thÆ°á»›c tháº­t
                    isInitialized = true;
                    gameView.getViewTreeObserver().removeOnGlobalLayoutListener(this);
                }
            }
        }
    );
}</code></pre>
        </div>

        <!-- 7. Design Patterns Section -->
        <div class="section" id="design-patterns">
            <h2>ğŸ—ï¸ 7. Design Patterns Ãp Dá»¥ng</h2>

            <div class="card-grid">
                <div class="card">
                    <h4>ğŸ”¹ Singleton Pattern</h4>
                    <p>Sá»­ dá»¥ng cho <span class="inline-code">SettingManager</span> vÃ  <span
                            class="inline-code">SoundManager</span> Ä‘á»ƒ Ä‘áº£m báº£o chá»‰ cÃ³ má»™t instance duy nháº¥t trong toÃ n
                        app.</p>
                    <pre><code>private static SoundManager instance;

public static SoundManager getInstance() {
    if (instance == null) {
        instance = new SoundManager();
    }
    return instance;
}</code></pre>
                </div>

                <div class="card">
                    <h4>ğŸ”¹ Observer Pattern (Callback)</h4>
                    <p>Sá»­ dá»¥ng interface callback Ä‘á»ƒ thÃ´ng bÃ¡o score thay Ä‘á»•i tá»« GameThread lÃªn Activity.</p>
                    <pre><code>public interface ScoreUpdateListener {
    void onScoreUpdated(int score);
}

// Trong Activity:
controller.setScoreUpdateListener(
    score -> runOnUiThread(() -> updateScore(score))
);</code></pre>
                </div>

                <div class="card">
                    <h4>ğŸ”¹ MVC-like Architecture</h4>
                    <p><strong>Model:</strong> Snake, Food, GameState<br>
                        <strong>View:</strong> GameView, Activities<br>
                        <strong>Controller:</strong> GameController, GameEngine
                    </p>
                </div>

                <div class="card">
                    <h4>ğŸ”¹ State Pattern</h4>
                    <p>GameState enum quáº£n lÃ½ tráº¡ng thÃ¡i: MENU â†’ PLAYING â†’ PAUSED â†’ GAME_OVER</p>
                    <pre><code>public enum GameState {
    MENU,
    PLAYING,
    PAUSED,
    GAME_OVER
}</code></pre>
                </div>
            </div>
        </div>

        <!-- 8. Architecture Diagram -->
        <div class="section" id="architecture">
            <h2>ğŸ”§ 8. SÆ¡ Äá»“ Kiáº¿n TrÃºc</h2>

            <h3>Class Diagram (Simplified)</h3>
            <div class="diagram">
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ MainActivity â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ â”‚ â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ MenuActivity â”‚ â”‚ GameActivity â”‚ â”‚ SettingActivity â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ GameController â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ â”‚ â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ GameEngine â”‚ â”‚ GameView â”‚ â”‚ GameThread â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Snake â”‚ â”‚ Food â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <h3>Sequence Diagram - Game Flow</h3>
            <div class="diagram">
                User GameActivity GameController GameEngine GameView
                â”‚ â”‚ â”‚ â”‚ â”‚
                â”‚ [Start Game] â”‚ â”‚ â”‚ â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚ â”‚ â”‚
                â”‚ â”‚ init() â”‚ â”‚ â”‚
                â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚ â”‚
                â”‚ â”‚ â”‚ initGame() â”‚ â”‚
                â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚
                â”‚ â”‚ â”‚ â”‚ â”‚
                â”‚ [Swipe] â”‚ â”‚ â”‚ â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚ â”‚ â”‚
                â”‚ â”‚ onFling() â”‚ â”‚ â”‚
                â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚ â”‚
                â”‚ â”‚ â”‚ changeDirection â”‚ â”‚
                â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚
                â”‚ â”‚ â”‚ â”‚ â”‚
                â”‚ â”‚ â”‚ [LOOP] â”‚ â”‚
                â”‚ â”‚ â”‚ update() â”‚ â”‚
                â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â”‚
                â”‚ â”‚ â”‚ â”‚ postInvalidate
                â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
                â”‚ â”‚ â”‚ â”‚ â”‚
                â”‚ â”‚ â”‚ â”‚ onDraw() â”‚
                â”‚ â”‚ â”‚ â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ </div>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p>ğŸ“ TÃ i liá»‡u Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng cho dá»± Ã¡n BTL Snake Game</p>
                <p>ğŸ“ BÃ i Táº­p Lá»›n - Láº­p TrÃ¬nh á»¨ng Dá»¥ng Di Äá»™ng</p>
                <p style="margin-top: 15px; font-size: 0.85rem;">
                    <span class="tag">Android</span>
                    <span class="tag blue">Java</span>
                    <span class="tag orange">Canvas 2D</span>
                    <span class="tag purple">Game Development</span>
                </p>
            </div>
        </div>
</body>

</html>